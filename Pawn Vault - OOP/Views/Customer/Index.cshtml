@model List<Pawn_Vault___OOP.Models.Customer>

<div class="overflow-x-auto">
    <table class="min-w-full table-auto">
        <thead class="bg-white">
            <tr class="grid grid-cols-2 sm:grid-cols-5 gap-4 py-3 border-b border-gray-200 text-sm sm:text-base">
                <th class="font-semibold text-gray-650 text-left col-span-1 sm:col-span-1">Profile</th>
                <th class="font-semibold text-gray-650 text-left hidden sm:block">Details</th>
                <th class="font-semibold text-gray-650 text-left hidden sm:block">Status</th>
                <th class="font-semibold text-gray-650 text-left hidden sm:block">Date</th>
                <th class="font-semibold text-gray-650 text-left hidden sm:block">Total</th>
            </tr>
        </thead>

        <tbody class="space-y-3 mt-3 block">
            @if (Model != null && Model.Any())
            {
                foreach (var customer in Model)
                {
                    <tr class="grid grid-cols-2 sm:grid-cols-5 gap-4 bg-gray-50 p-3 rounded-lg items-center text-sm sm:text-base mb-3">
                        <td class="flex items-center space-x-2 col-span-1 sm:col-span-1">
                            <div class="rounded-full border border-gray-400 p-1 flex-shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                          d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                            </div>
                            <span class="text-gray-700 font-medium">@customer.CustomerFN @customer.CustomerLN</span>
                        </td>

                        <td class="text-gray-700 hidden sm:block">@customer.TelephoneNo</td>

                        <td class="text-gray-700 hidden sm:block">
                            @(
                                                customer.Loans == null || !customer.Loans.Any()
                                                ? "No Loans"
                                                : customer.Loans.Any(l => l.Status == "Active") ? "Active"
                                                : customer.Loans.All(l => l.Status == "Paid") ? "Paid"
                                                : "Inactive"
                                                )
                </td>

                        <td class="text-gray-700 hidden sm:block">
                    @{
                                var latestLoan = customer.Loans?
                                .OrderByDescending(l => l.Date)
                                .FirstOrDefault();
                            }
                            @latestLoan?.Date.ToShortDateString() ?? "No Loan"
                        </td>

                        <td class="text-gray-700 hidden sm:block">
                            ₱@customer.Loans?.Sum(l => l.Amount).ToString("N2")
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr class="text-center text-gray-600 text-sm sm:text-base">
                    <td colspan="5" class="py-4">
                        <em>No customers are available.</em>
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>
